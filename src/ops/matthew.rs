use rand::{Rng, rng};
use teloxide::{
    Bot,
    types::{Me, Message},
};

use crate::ops::{error::Error, quotes::random_string_from, send::send_reply_message_set_reaction};

const POOL: &[&str] = &[
    "Ð¢Ñ‹ ÑÐ´Ð¾Ñ…Ð½ÐµÑˆÑŒ Ð² Ð°Ð´Ñƒ ÑƒÑ€Ð¾Ð´",
    "Ð¯ Ð±Ñ‹ Ñ‚ÐµÐ±Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¿Ð¾ Ñ‚Ð²Ð¾ÐµÐ¹ Ð»Ñ‹ÑÐ¸Ð½Ðµ Ð²Ð¾Ð½ÑŽÑ‡ÐµÐ¹ c Ð¿Ñ‹Ñ€Ñƒ Ð²ÑŠÐµÐ±Ð°Ð»",
    "Ð¸ Ñ‡Ðµ ? Ñ‚ÐµÐ±Ñ Ð½Ð°Ñ…ÑƒÑÑ€Ð¸Ñ‚ÑŒ Ñ‡Ñ‚Ð¾Ð»Ð¸ Ñ‚Ñ‹ Ð¸Ð¼ÐµÐµÑˆÑŒ Ð²Ð²Ð¸Ð´Ñƒ ?",
    "Ð¯ ÑÑÐ°Ð» ÑÑ‚Ñ€Ð¸Ð¼ Ð½Ð° Ð³Ð¾Ð»Ð¾Ð²Ñƒ Ð¿ÐµÑ‚Ð¸Ð½Ñƒ",
    "Ñ‚ÐµÑ€Ð¿Ð¸Ð¼",
    "Ð˜Ð·Ð²Ð¸Ð½Ð¸Ñ‚Ðµ",
    "Ð¥Ð¾Ñ€Ð¾ÑˆÐ¾ Ð±Ñ€Ð°Ñ‚Ð¾Ðº Ð¸Ð´ÐµÐ¼ 1x1 Ñ ÐºÐ°Ð¶Ð´Ñ‹Ð¼ 5 Ñ€Ð°ÑƒÐ½Ð´Ð¾Ð² Ð¿Ð¾ Ð¿Ð¾Ð» Ñ‡Ð°ÑÐ°",
    "ÐÐ¸Ñ…ÑƒÑ Ð²Ñ‹ Ð±Ð°Ð·Ð°Ñ€Ð¸Ñ‚Ðµ, ÑƒÑ€Ð¾Ð´Ñ‹",
    "Ð’ ÑÑ‚Ð¾Ñ‚ Ð´ÐµÐ½ÑŒ Ñ Ð¸ Ð¿Ð¾Ñ€Ð²Ð°Ð» ÑÑ‚Ð¸ ÑˆÐ¾Ñ€Ñ‚Ñ‹",
    "Ñ Ð¿ÐµÑ‚ÑƒÑ… Ð² Ð·Ð°ÐºÐ¾Ð½Ðµ",
    "Ð’Ð¾Ñ‚ Ð¸Ð¼ÐµÐ½Ð½Ð¾, Ð»Ð¸Ð±ÐµÑ€Ð°Ð»Ñ‹ Ð¿Ð¸Ð´Ð¾Ñ€Ð°ÑÑ‹",
    "Ð“ÑƒÐ±Ð°Ð¼Ð¸",
    "Ð¯ ÐŸÑƒÑ‚Ð¸Ð½",
    "Ð¯ Ð±ÐµÐ»Ð¾Ð³Ð²Ð°Ñ€Ð´ÐµÐµÑ†",
    "Ð²ÑÐµ ÐºÐ°Ðº Ð¿Ð°Ð¿Ð° ÑƒÑ‡Ð¸Ð», Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð½Ð°Ð´Ð¾ ÐµÑ‰Ðµ Ð³Ð¾Ð»Ñ‹Ð¼",
    "Ð°Ñ…Ñ‚ÑƒÐ±Ð¸Ð½ÑÐº Ð³Ð¾Ñ€Ð¾Ð´ Ð·Ð°Ð´Ð½ÐµÐ¿Ñ€Ð¸Ð²Ð¾Ð´Ð½Ñ‹Ñ…",
    "Ð½Ðµ Ð¿Ð¾Ð½ÑÐ», ÐºÑƒÐºÐ¾Ð»Ð´ Ð¼Ð¾Ñ Ð±Ð°Ð±ÑƒÑˆÐºÐ°?",
    "ÑÐ»Ñ‹ÑˆÑŒ Ñ‚Ñ‹ Ð½Ð°Ñ…ÑƒÐ¹, Ð±Ð°Ð±Ð° Ñ‚Ñ‹ ÐµÐ±Ð°Ð½Ð°Ñ",
    "Ð°Ð½Ð¸Ð¼Ðµ Ð²Ð¾Ð¾Ð±Ñ‰Ðµ Ð´Ð»Ñ Ð´Ð°ÑƒÐ½Ð¾Ð²",
    "/pidor@UserOfTheDayBot",
    "Ð¢ÐµÐ±Ðµ Ñ…ÑƒÐµÐ¼ Ð¶Ð¾Ð¿Ñƒ Ð·Ð°ÐºÑ€Ñ‹Ð»Ð¸ Ð³Ð°Ð½Ð´Ð¾Ð½ Ð±Ð»ÑÑ‚ÑŒ",
    "Ñ Ð¿Ñ€Ð¸Ð½ÐµÑÑƒ Ñ‚ÐµÐ±Ðµ Ð³Ð¾Ð²Ð½Ð° Ð½Ð°Ñ…ÑƒÐ¹",
    "Ñ…Ð¾Ñ€Ð¾ÑˆÐ¾ ÐºÑƒÐºÐ¾Ð»Ð´ ÑÑƒÐºÐ°",
];

/// Send random quote with 30% chance.
///
/// # Panics
///
/// Panics if message text was empty.
///
/// # Errors
///
/// This function will return an error if message text was empty.
pub async fn send_random_matthew_quote(bot: Bot, message: Message, me: Me) -> Result<(), Error> {
    Ok(if should_reply() {
        send_reply_message_set_reaction(&random_string_from(POOL), "ðŸ†", &bot, &message, &me).await
    })
}

/// Return true with 30% chance.
fn should_reply() -> bool {
    let mut rng = rng();
    rng.random_bool(0.3) // 30% chance for reply (as irl)
}
